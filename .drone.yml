---
kind: pipeline
type: kubernetes
name: ssr-deploy

steps:
  # - name: Build Docker Image
  #   image: plugins/docker
  #   settings:
  #     registry: git.fascinated.cc
  #     repo: git.fascinated.cc/fascinated/scoresaber-reloaded
  #     username:
  #       from_secret: username
  #     password:
  #       from_secret: token
  #     tags:
  #       - latest

  - name: Deploy SSR
    image: danielgormly/drone-plugin-kube:0.2.0
    settings:
      build_number: ${DRONE_BUILD_NUMBER}
      template: deployment.yaml
      ca:
        from_secret: k8s_crt
      server:
        from_secret: k8s_server
      token:
        from_secret: k8s_token
